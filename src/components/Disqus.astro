<div id="disqus_thread"></div>
<script is:inline>
    function disqus(){
        // Clear the thread first
        const pageIdentifier = window.location.pathname;
        const pageUrl = "https://bosc.org.np"+pageIdentifier;
        console.log("pageUrl:", pageUrl);
        const thread = document.getElementById('disqus_thread');
        if (thread) thread.innerHTML = '';
        
        // If DISQUS already loaded, reset it
        if (window.DISQUS) {
            window.DISQUS.reset({
                reload: true,
                config: function () {
                    this.page.url = pageUrl;
                    this.page.identifier = pageIdentifier;
                }
            });
        } else {
            // First time loading
            var disqus_config = function () {
                    this.page.url = pageUrl;
                    this.page.identifier = pageIdentifier;
            };
            
            (function() {
                var d = document, s = d.createElement('script');
                s.src = 'https://bosc-1.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        }
    }
    
    disqus(); // Initial load
    document.addEventListener('astro:page-load', disqus); // Note: no parentheses!
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>